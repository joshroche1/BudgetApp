{% extends 'base.html' %}

{% block title %}
{% if g.user %}
Transaction List
{% else %}
{% endif %}
{% endblock %}

{% block header %}
{% if g.user %}
Transaction List
{% else %}
{% endif %}
{% endblock %}

{% block navbar %}
<li class="nav-item"><a href="" class="nav-link btn btn-sm">|</a></li>
<li class="nav-item">
  <a href="/transaction/list" class="nav-link btn btn-sm btn-secondary">LIST</a>
</li>
<li class="nav-item">
  <a href="/transaction/importview" class="nav-link btn btn-sm btn-secondary">IMPORT</a>
</li>
<li class="nav-item"><a href="" class="nav-link btn btn-sm">|</a></li>
<li class="nav-item">
  <button class="nav-link btn btn-sm btn-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#filterpanel" aria-expanded="false" aria-controls="filterpanel">Filters</button>
</li>
{% endblock %}

{% block content %}
{% if g.user %}
<div id="filterpanel" class="collapse m-1 p-1">
  <div class="row">
    
    <div class="col">
      <form action="#" method="">
        <div class="input-group">
          <input type="hidden" id="filterkey" name="filterkey" value="Category">
          <select id="filtervalue" name="filtervalue" class="form-select">
            <option value="" selected disabled>Category</option>
            {% for category in categories %}
            <option value="{{ category.value }}">{{ category.value }}</option>
            {% endfor %}
          </select>
          <input type="submit" value="Filter" class="btn btn-sm btn-success">
        </div>
      </form>
    </div>
    <div class="col">
      <form action="/transaction/list/filtered/month" method="post">
        <div class="input-group">
          <select id="month" name="month" class="form-select">
            <option value="" selected disabled>Month</option>
            <option value="01">JAN</option>
            <option value="02">FEB</option>
            <option value="03">MAR</option>
            <option value="04">APR</option>
            <option value="05">MAY</option>
            <option value="06">JUN</option>
            <option value="07">JUL</option>
            <option value="08">AUG</option>
            <option value="09">SEP</option>
            <option value="10">OCT</option>
            <option value="11">NOV</option>
            <option value="12">DEC</option>
          </select>
          <input type="submit" value="Filter" class="btn btn-sm btn-success">
        </div>
      </form>
    </div>
    <div class="col">
      <form action="/transaction/list/filtered/date" method="post">
        <div class="input-group">
          <span class="input-group-text">Start</span>
          <input type="date" id="startdate" name="startdate" class="form-control">
          <span class="input-group-text">End</span>
          <input type="date" id="enddate" name="enddate" class="form-control">
          <input type="submit" value="Filter" class="btn btn-sm btn-success">
        </div>
      </form>
    </div>
    
  </div>
</div>

<div class="m-3 p-3">
  
  <button type="button" data-bs-toggle="collapse" data-bs-target="#createpanel" aria-expanded="false" aria-controls="createpanel" class="btn btn-sm btn-success">NEW</button>
  <div id="createpanel" class="collapse">
    <form action="/transaction/create" method="post">
      <div class="row">
        <div class="col-12 col-sm-6 col-md-4 col-lg-3">
          <input type="datetime-local" id="datetimestamp" name="datetimestamp" class="form-control" required />
        </div>
        <div class="col-12 col-sm-6 col-md-4 col-lg-3">
          <input type="text" id="amount" name="amount" placeholder="Amount" class="form-control" required />
        </div>
        <div class="col-12 col-sm-6 col-md-4 col-lg-3">
          <select id="category" name="category" class="form-select">
            <option value="" disabled selected>Select a Category</option>
            {% for category in categories %}
            <option value="{{ category.value }}">{{ category.value }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-12 col-sm-6 col-md-4 col-lg-3">
          <input type="text" id="name" name="name" placeholder="Name" class="form-control" required />
        </div>
      </div>
      <div class="btn-group" role="group" aria-label="Submit Reset group">
        <input type="submit" value="&#9655;" class="btn btn-sm btn-success">
        <input type="reset" value="&#8634;" class="btn btn-sm btn-secondary">
      </div>
    </form>
  </div>
  
  <table class="table table-hover table-bordered">

    <tr>
      <th><a href="/transaction/list/sorted/id" class="btn btn-sm">ID</a></th>
      <th><a href="/transaction/list/sorted/datetimestamp" class="btn btn-sm">Date</a></th>
      <th><a href="/transaction/list/sorted/amount" class="btn btn-sm">Amount</a></th>
      <th><a href="/transaction/list/sorted/currency" class="btn btn-sm">Currency</a></th>
      <th><a href="/transaction/list/sorted/category" class="btn btn-sm">Category</a></th>
      <th><a href="/transaction/list/sorted/name" class="btn btn-sm">Name</a></th>
      <th><a href="" class="btn btn-sm">Description</a></th>
      <th><a href="/transaction/list/sorted/accountid" class="btn btn-sm">Account ID</a></th>
    </tr>

    {% for transaction in transactionlist %}
    <tr>
      <td>{{ transaction.id }}</td>
      <td>{{ transaction.datetimestamp }}</td>
      <td>{{ transaction.amount }}</td>
      <td>{{ transaction.currency }}</td>
      <td>{{ transaction.category }}</td>
      <td><a href="/transaction/detail/{{ transaction.id }}" class="btn btn-sm btn-light"><b>{{ transaction.name }}</b></a></td>
      <td>{{ transaction.description }}</td>
      <td>{{ transaction.accountid }}</td>
    </tr>
    {% endfor %}

  </table>
</div>

{% else %}
<div class="container">
</div>
{% endif %}

{% endblock %}
